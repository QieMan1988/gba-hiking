# 游戏设计文档变更记录

## 2026年1月30日 - 文档整合与归档

### 变更类型
文档整合与归档

### 变更内容

#### 1. 创建最终版游戏设计文档
- **文件**：`docs/design/game_design_doc_final.md`
- **版本号**：v7.0
- **内容**：完整整合 `game_design_doc.md` (v5.4) 与 `game_design_doc_v6.0.md` (v6.0)
- **特点**：
  - 无内容省略，所有章节均已完整填充
  - 逻辑清晰，前后文保持一致性
  - 整合了累积爬升、上坡下坡机制、补给系统、疲劳系统
  - 基于真实路线（麦理浩径、澳门路线）设计关卡

#### 2. 关卡顺序调整
- **调整前**：路环东北步行径为普通新手关（未明确位置）
- **调整后**：路环东北步行径设定为新手教学第0关
- **原因**：路环东北步行径距离短（4.3km）、累积爬升低（60m）、地形平缓，最适合完全新手入门

#### 3. 旧文档归档
- **归档文件**：
  - `game_design_doc.md` (v5.4) → `archive/game_design_doc.md`
  - `game_design_doc_v6.0.md` (v6.0) → `archive/game_design_doc_v6.0.md`
- **归档位置**：`docs/design/archive/`

### 文档结构对比

#### v5.4 文档结构
```
1. 核心玩法设计
2. 卡牌系统设计
3. 数值与平衡（基础版本，无累积爬升、补给、疲劳系统）
4. 关卡与流程（基础版本，无真实路线参考）
5. UI/UX设计
6. 游戏生命周期
```

#### v6.0 文档结构
```
1. 核心玩法设计（增加了累积爬升、上坡下坡机制）
2. 卡牌系统设计（部分省略）
3. 数值与平衡（增加了补给系统、疲劳系统）
4. 关卡与流程（增加了真实路线参考，部分省略）
5. UI/UX设计（省略）
6. 游戏生命周期（省略）
```

#### v7.0 最终文档结构
```
1. 核心玩法设计（完整，包含累积爬升、上坡下坡机制、文化元素）
2. 卡牌系统设计（完整，无省略）
3. 数值与平衡（完整，包含补给系统、疲劳系统）
4. 关卡与流程（完整，基于真实路线，无省略）
5. UI/UX设计（完整，无省略）
6. 游戏生命周期（完整，无省略）
附录A：术语表
附录B：版本更新记录
附录C：参考资料索引
```

### 关键设计更新

#### 1. 货币系统调整
- **v5.4**：使用"海拔数"作为特殊货币
- **v6.0**：将"海拔数"改为"累积爬升"
- **v7.0**：确认使用"累积爬升"，明确定义：
  - 累积爬升 = Σ(所有上坡路段的垂直上升高度)
  - 下坡路段不计入累积爬升
  - 平路（坡度<5%）不计入累积爬升

#### 2. 体能消耗公式
- **v5.4**：基于地形类型直接设定消耗
- **v6.0**：引入公式
  ```
  体能消耗 = (徒步距离 / 20) + (累积爬升 / 20)
  ```
- **v7.0**：确认该公式，并明确基准：
  - 初始体能 100 = 20 公里徒步 或 2000 米累积爬升

#### 3. 补给系统
- **v5.4**：无补给系统
- **v6.0**：引入补给系统
  - 每 10 公里徒步需要 2 瓶水 + 1 瓶运动饮料 + 1 次巧克力补给
- **v7.0**：完整整合，包括补给点设计、补给不足警告

#### 4. 疲劳系统
- **v5.4**：无疲劳系统
- **v6.0**：引入疲劳系统
  - 每 5 公里徒步需要 1 次休息缓解疲劳
- **v7.0**：完整整合，包括疲劳计算公式、休息机制、疲劳突破机制

#### 5. 上坡下坡机制
- **v5.4**：无上坡下坡机制
- **v6.0**：引入上坡下坡机制
  - 上坡计入累积爬升，消耗大
  - 下坡不计入累积爬升，消耗小，有膝盖磨损风险
- **v7.0**：完整整合，包括地形坡度识别、上坡/下坡机制、膝盖损伤机制

#### 6. 关卡设计
- **v5.4**：虚构关卡，层数为5/7/9/11层
- **v6.0**：参考真实路线（麦理浩径），增加澳门路线
- **v7.0**：完整整合，包括：
  - 新手教学关（第0关）：路环东北步行径（4.3km，60m爬升）
  - 新手关（第1-3关）：香港郊野公园入门（10km，150-450m爬升）
  - 澳门新手关（第1.5关）：路环步行径（8.1km，80m爬升）
  - 标准关（第4-6关）：参考麦理浩径第2-4段（14km，400-600m爬升）
  - 挑战关（第7-9关）：参考麦理浩径第5-8段（18km，600-800m爬升）
  - 精英关（第10关）：参考麦理浩径第7段（22km，800-1000m爬升）
  - BOSS关（第11+关）：参考麦理浩径第10段（26km，1000-1200m爬升）

### 文档完整性检查

| 章节 | v5.4 | v6.0 | v7.0 | 备注 |
|------|------|------|------|------|
| 1. 核心玩法设计 | 完整 | 部分省略 | 完整 | 整合所有内容 |
| 1.7 规则边界与异常处理 | 完整 | 部分更新 | 完整 | 整合累积爬升边界 |
| 1.8 文化元素融入 | 完整 | 保持原有 | 完整 | 保留完整内容 |
| 2. 卡牌系统设计 | 完整 | 省略 | 完整 | 完整填充省略部分 |
| 3. 数值与平衡 | 完整 | 部分更新 | 完整 | 整合补给、疲劳系统 |
| 3.2 经济系统 | 完整 | 更新 | 完整 | 确认使用累积爬升 |
| 3.3 难度曲线 | 完整 | 更新 | 完整 | 整合真实路线参考 |
| 3.4 补给系统 | 无 | 新增 | 完整 | 完整整合 |
| 3.5 疲劳系统 | 无 | 新增 | 完整 | 完整整合 |
| 4. 关卡与流程 | 完整 | 部分省略 | 完整 | 完整填充省略部分 |
| 4.2 关卡长度与距离设计 | 完整 | 新增 | 完整 | 整合地形生成规则 |
| 4.3 上坡下坡机制 | 无 | 新增 | 完整 | 完整整合 |
| 4.5 关卡设计示例 | 完整 | 更新 | 完整 | 整合真实路线示例 |
| 5. UI/UX设计 | 完整 | 省略 | 完整 | 完整填充省略部分 |
| 6. 游戏生命周期 | 完整 | 保持原有 | 完整 | 保留完整内容 |
| 附录A：术语表 | 完整 | 保持原有 | 完整 | 更新累积爬升术语 |
| 附录B：版本更新记录 | 完整 | 更新 | 完整 | 整合所有版本 |
| 附录C：参考资料索引 | 完整 | 保持原有 | 完整 | 保留完整内容 |

### 影响范围

**直接影响的文档**：
- ✅ `docs/design/game_design_doc_final.md`（新创建）
- ✅ `docs/design/archive/game_design_doc.md`（已归档）
- ✅ `docs/design/archive/game_design_doc_v6.0.md`（已归档）

**间接影响的文档**（建议更新）：
- ⚠️ `docs/technical/technical_architecture.md`（需根据最终版文档调整数值体系）
- ⚠️ `autoloads/` 目录下的8个管理器实现代码（需根据最终版文档确认逻辑）
- ⚠️ `config/` 目录下的4个配置文件（需根据最终版文档更新数据）

### 后续建议

1. **更新技术架构文档**
   - 根据 `game_design_doc_final.md` 的数值体系调整 `technical_architecture.md`
   - 确认累积爬升、补给系统、疲劳系统的技术实现方案

2. **确认管理器实现代码**
   - 检查 `autoloads/` 目录下的8个管理器实现代码
   - 确认是否符合最终版文档的设计要求

3. **更新配置文件**
   - 根据 `game_design_doc_final.md` 的关卡设计更新关卡配置
   - 根据最终版文档的数值体系调整数值配置

4. **创建关卡配置文件**
   - 根据最终版文档的关卡设计示例创建关卡配置文件
   - 包括新手教学关（路环东北步行径）、新手关、澳门新手关等

### 变更负责人
游戏设计团队

### 审核状态
- ✅ 文档整合完成
- ✅ 旧文档归档完成
- ✅ 关卡顺序调整完成
- ✅ 变更记录创建完成

### 生效日期
2026年1月30日

---

## 历史变更

### 2026年1月28日 - v5.4版本更新
- 将规则边界定义和文化元素整合融入核心玩法章节
- 删除独立玩法深度分析和体验量化指标章节
- 调整文档结构，保持6章核心架构

### 2026年1月30日 - v6.0版本更新
- 整合累积爬升、上坡下坡机制、补给系统、疲劳系统
- 参考真实路线（麦理浩径、澳门路线）设计关卡
- 更新体能消耗公式

### 2026年1月30日 - v7.0最终版整合
- 完整整合v5.4和v6.0两份文档
- 无内容省略，所有章节均已完整填充
- 调整关卡顺序（路环东北步行径为新手教学关）
- 归档旧版文档到 `archive/` 目录
