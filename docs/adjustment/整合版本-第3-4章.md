# 整合版本：游戏设计文档（第3、4章）

**说明**：本文档将数值体系调整方案和关卡设计整合到游戏设计文档的第3章和第4章中。

---

## 3. 数值与平衡

### 3.1 基准标准

**基准设定**：
- 初始体能 100 = 20 公里徒步 或 2000 米累积爬升
- 每 10 公里徒步 = 产生 20,000 徒步数
- 每 5 公里徒步需要 1 次休息缓解疲劳才能继续（游戏中后期可突破）
- 每 10 公里徒步需要 2 瓶水 + 1 瓶运动饮料 + 1 次巧克力补给

### 3.2 五维属性系统

#### 3.2.1 属性定义

| 属性 | 取值范围 | 起始值 | 主要影响 |
|------|---------|--------|---------|
| **体能**<br>(主属性) | 0-100 | 100 | 视为生命值，为0则游戏结束。1点体能 = 0.2公里徒步 或 20米累积爬升。影响负重上限（公式：基础负重+体能*系数）。所有其他属性变化都会间接影响体能。 |
| **疲劳** | 0-20 | 0 | 体能降低的缓冲区。累积公式：`(徒步距离 / 5) + (累积爬升 / 250)`。高疲劳会降低所有行动效率。 |
| **饥饿** | 0-100 | 100 | 正向影响体能恢复速率。低于阈值时，体能恢复大幅减慢。 |
| **口渴** | 0-100 | 100 | 正向影响体能恢复速率。与饥饿共同作用，缺水影响更显著。 |
| **心率** | 80-180 | 110 | 反映运动强度。80-100无影响；100-180区间，心率越高，体能恢复速率越低，疲劳累积越快。 |

#### 3.2.2 体能消耗计算

**体能消耗公式**：
```
体能消耗 = (徒步距离 / 20) + (累积爬升 / 20)

其中：
- 徒步距离单位：公里
- 累积爬升单位：米
- 体能消耗结果：点

示例：
- 徒步10公里平路 = 10 / 20 = 50点体能
- 徒步10公里，其中5公里平路，5公里上坡（爬升200米） = (5/20) + (200/20) = 25 + 100 = 125点体能
```

**地形障碍体能消耗调整**：

| 地形类型 | 每公里体能消耗 | 累积爬升（每公里） | 总体能消耗 | 徒步数奖励 |
|---------|---------------|------------------|-----------|-----------|
| **平坦道路** | 5点 | 0m | 5点 | 100 |
| **缓坡（上坡）** | 8点 | 50m | 10.5点 | 200 |
| **陡坡** | 15点 | 150m | 22.5点 | 450 |
| **乱石路** | 12点 | 80m | 16点 | 320 |
| **溪流** | 8点 | 20m | 9点 | 180 |
| **悬崖栈道** | 20点 | 300m | 35点 | 700 |

#### 3.2.3 疲劳计算

**疲劳积累公式**：
```
疲劳积累 = (徒步距离 / 5) + (累积爬升 / 250)

示例：
- 徒步5公里平路 = 5/5 = 1次休息
- 徒步10公里，其中8公里平路，2公里上坡（爬升400米） = (8/5) + (400/250) = 1.6 + 1.6 = 3.2 ≈ 3次休息
```

#### 3.2.4 属性颜色编码

（保持原有的颜色编码设计）

### 3.3 经济系统

#### 3.3.1 三种货币

| 货币类型 | 功能 | 局内/局外 | 获取方式 | 用途 |
|---------|------|----------|---------|------|
| **徒步数** | 局外经验 | 局外 | 徒步距离累积（每1公里=2,000徒步数） | 局外角色属性升级 |
| **累积爬升** | 局外稀有货币 | 局外 | 通关奖励（每关根据实际爬升计算） | 局外兑换高级装备、解锁装备槽位 |
| **环保值** | 局内货币 | 局内 | 消除环境卡、完成环保行为 | 局内商店购买物品+照片卡包 |

**关键变化**：
- "海拔数" → "累积爬升"
- 徒步数获得方式：从"消除卡牌"改为"徒步距离累积"
- 累积爬升计算：根据关卡中所有上坡路段的实际爬升计算

#### 3.3.2 徒步数计算

**徒步数计算公式**：
```
徒步数 = 徒步距离（公里）× 2,000

示例：
- 徒步10公里 = 10 × 2,000 = 20,000徒步数
- 徒步14公里 = 14 × 2,000 = 28,000徒步数
- 徒步26公里 = 26 × 2,000 = 52,000徒步数
```

#### 3.3.3 商店系统

**商店类型**：（保持原有的商店类型设计）

**资源卡调整**：

| 资源卡名称 | 恢复效果 | 环保值消耗 | 补给单位 |
|-----------|---------|-----------|---------|
| **矿泉水** | 口渴+20 | 25环保值 | 1瓶 |
| **运动饮料** | 口渴+15，疲劳-5 | 50环保值 | 1瓶 |
| **巧克力** | 体能+15，饥饿+20 | 75环保值 | 1次 |
| **能量棒** | 体能+20，饥饿+15 | 100环保值 | 1次 |
| **香蕉** | 体能+10，钾元素+20 | 60环保值 | 1次 |
| **电解质水** | 口渴+30，心率-10 | 80环保值 | 1瓶 |
| **运动补给包** | 口渴+25，体能+20，疲劳-10 | 150环保值 | 1次（综合补给） |

#### 3.3.4 补给需求计算

**补给需求公式**：
```
需水量 = 徒步距离 / 5
需运动饮料量 = 徒步距离 / 10
需巧克力补给次数 = 徒步距离 / 10

示例（10公里徒步）：
- 需水量：10 / 5 = 2瓶
- 需运动饮料：10 / 10 = 1瓶
- 需巧克力补给：10 / 10 = 1次
- 总环保值需求：约400环保值
```

#### 3.3.5 补给不足处理

**补给不足警告**：
```
当徒步距离达到5公里但补给不足时，显示警告：

⚠️ 补给不足警告
─────────────────────
你已经徒步了5公里，但补给不足！

当前补给状态：
- 水：0.8/1.0瓶 ❌
- 运动饮料：0.4/0.5瓶 ❌
- 巧克力：0.4/0.5次 ❌

后果：
- 口渴/饥饿恢复速率降低至5%
- 疲劳积累速度加快50%
- 体能消耗增加10%

建议：
- 在下一层寻找游动商贩或景区商店
- 合理使用环保值购买补给

[前往下一层] [查看商店]
```

### 3.4 累积爬升概念

#### 3.4.1 累积爬升定义

**定义**：
- 累积爬升（Cumulative Elevation Gain）是指整个行程中所有上坡路段的垂直上升高度之和
- 下坡路段的垂直下降高度不计入累积爬升中
- 平路（坡度<5%）不计入累积爬升

**公式**：
```
累积爬升 = Σ(所有上坡路段的垂直上升高度)

其中：
- 上坡路段：坡度 ≥ 5% 且 海拔上升 > 0
- 垂直上升高度 = 路段长度 × sin(坡度角)
```

#### 3.4.2 地形坡度分级

| 地形类型 | 坡度范围 | 垂直上升系数（每公里） | 累积爬升计算 |
|---------|---------|---------------------|------------|
| **平坦道路** | 0-5% | 0m/km | 不计入累积爬升 |
| **缓坡（上坡）** | 5-15% | 30-80m/km | 计入累积爬升 |
| **陡坡** | 15-30% | 80-280m/km | 计入累积爬升 |
| **悬崖栈道** | >30% | >280m/km | 计入累积爬升 |

#### 3.4.3 累积爬升与海拔的区别

| 概念 | 定义 | 计算方式 | 游戏中的应用 |
|------|------|---------|------------|
| **海拔** | 某个地点相对于海平面的高度 | 相对于0米的绝对高度 | 关卡背景、视觉表现 |
| **累积爬升** | 整个行程中所有上坡的垂直上升高度之和 | 所有上坡路段的垂直上升高度累加 | 局外货币、难度评估、关卡设计 |

**示例**：
- 从海拔220m爬升到400m，再下降到350m，再爬升到450m
- 海拔变化：220m → 400m → 350m → 450m
- 累积爬升 = (400-220) + (450-350) = 180m + 100m = 280m
- 海拔增益 = 450m - 220m = 230m

### 3.5 难度曲线

#### 3.5.1 关卡长度递增机制

**新的层级设定**：
- 每层代表约2公里的徒步距离（根据麦理浩径等真实路线）
- 每层的累积爬升根据地形类型动态计算

**层级结构调整**：

| 关卡类型 | 总层数 | 总徒步距离 | 每层卡牌数（从下到上） | 每层徒步距离（公里） |
|---------|-------|-----------|---------------------|---------------------|
| **前段关 (1-3)** | 5层 | 10公里 | 4-3-3-2-1 | 每层2公里 |
| **中段关 (4-6)** | 7层 | 14公里 | 4-4-4-4-3-2-1 | 每层2公里 |
| **后段关 (7-9)** | 9层 | 18公里 | 5-5-5-5-4-3-2-2-1 | 每层2公里 |
| **精英关 (10)** | 11层 | 22公里 | 6-6-6-5-4-3-3-2-2-1-1 | 每层2公里 |
| **BOSS关 (11)** | 13层 | 26公里 | 特殊设计 | 每层2公里 |

#### 3.5.2 关卡难度分级

**新的关卡分级**：

| 关卡类型 | 关卡编号 | 适合玩家 | 总层数 | 总距离 | 累积爬升 | 难度 | 补给点 |
|---------|---------|---------|-------|--------|---------|------|-------|
| **新手关** | 1-3 | 初学者 | 5层 | 10公里 | 200-400m | ⭐⭐ | 每2层 |
| **标准关** | 4-6 | 轻度玩家 | 7层 | 14公里 | 400-600m | ⭐⭐⭐ | 每2-3层 |
| **挑战关** | 7-9 | 重度玩家 | 9层 | 18公里 | 600-800m | ⭐⭐⭐⭐ | 每3层 |
| **精英关** | 10 | 专家玩家 | 11层 | 22公里 | 800-1000m | ⭐⭐⭐⭐⭐ | 每3层 |
| **BOSS关** | 11+ | 大师玩家 | 13层 | 26公里 | 1000-1200m | ⭐⭐⭐⭐⭐⭐ | 每3层 |

#### 3.5.3 参考真实路线

**麦理浩径（MacLehose Trail）**：

| 段号 | 距离（公里） | 累积爬升（米） | 难度 | 关卡对应 |
|------|------------|--------------|------|---------|
| **第1段** | 10.6 | 450 | ⭐⭐ | 关卡1-2 |
| **第2段** | 13.5 | 550 | ⭐⭐⭐ | 关卡3-4 |
| **第3段** | 9.8 | 400 | ⭐⭐ | 关卡5 |
| **第4段** | 12.8 | 580 | ⭐⭐⭐⭐ | 关卡6-7 |
| **第5段** | 10.6 | 450 | ⭐⭐⭐ | 关卡8 |
| **第6段** | 5.2 | 320 | ⭐⭐ | 关卡9 |
| **第7段** | 10.5 | 650 | ⭐⭐⭐⭐ | 关卡10（精英） |
| **第8段** | 9.2 | 420 | ⭐⭐⭐ | 关卡11 |
| **第9段** | 9.6 | 500 | ⭐⭐⭐⭐ | 关卡12 |
| **第10段** | 15.6 | 620 | ⭐⭐⭐⭐⭐ | 关卡13（BOSS） |
| **总计** | 107.4 | 4940 | - | - |

**说明**：
- 麦理浩径全程约107公里，累积爬升约5000米
- 玩家无法在没有补给的情况下完成所有10段
- 初期只需要通过5-7关（对应第1-6段）
- 精英关和BOSS关需要一定经验才能挑战

### 3.6 平衡调整机制

**动态平衡补偿机制**：根据玩家当前局内表现动态微调资源掉落率与商店价格，防止经济系统崩溃并维持挑战性。

---

## 4. 关卡与流程

### 4.1 上坡下坡机制

#### 4.1.1 地形坡度识别系统

**关卡生成时，每层会被分配一个地形类型**：

| 地形类型 | 坡度 | 累积爬升（每层） | 下坡概率 | 特殊机制 |
|---------|------|----------------|---------|---------|
| **平坦道路** | 0-5% | 0m | 0% | 无特殊机制 |
| **缓坡上坡** | 5-15% | 100m | 10% | 体能消耗增加 |
| **陡坡上坡** | 15-30% | 300m | 15% | 疲劳增加，可能触发"呼吸急促" |
| **悬崖栈道** | >30% | 600m | 20% | 恐惧状态，需要确认翻越 |
| **缓坡下坡** | -15%到-5% | 0m（不计入） | 100% | 体能消耗减少，但可能触发"膝盖疼痛" |
| **陡坡下坡** | -30%到-15% | 0m（不计入） | 100% | 体能消耗大幅减少，但可能触发"膝盖磨损" |

#### 4.1.2 上坡机制

**上坡特征**：
- 计入累积爬升
- 体能消耗增加
- 疲劳积累加快
- 心率上升

**上坡视觉效果**：
- 层级显示：向上箭头🔼（红色表示陡坡，橙色表示缓坡）
- 背景渐变：从下方向上方颜色加深
- 海拔数值：显示当前累积爬升

#### 4.1.3 下坡机制

**下坡特征**：
- 不计入累积爬升
- 体能消耗减少
- 可能触发"膝盖疼痛"或"膝盖磨损"
- 速度加快，操作节奏变快

**下坡视觉效果**：
- 层级显示：向下箭头🔽（红色表示陡坡下坡，橙色表示缓坡下坡）
- 背景渐变：从上方向下方颜色变浅
- 海拔数值：显示海拔下降（不计入累积爬升）

#### 4.1.4 累积爬升显示

**界面显示**：

```
┌─────────────────────────────────┐
│  徒步进度                        │
│  ─────────────────────           │
│  已徒步：12.5 / 20.0 公里       │
│  ██████████░░░░░░░░░░░           │
│                                 │
│  累积爬升：850 / 1200 米         │
│  ████████░░░░░░░░░░░░░░           │
│                                 │
│  当前海拔：420m                  │
└─────────────────────────────────┘
```

### 4.2 动态关卡系统

#### 4.2.1 关卡生成逻辑

**关卡生成流程**：

1. **确定关卡类型**：根据游玩次数和玩家经验
2. **确定总层数**：5/7/9/11/13层
3. **生成地形序列**：确保上坡下坡的合理分布
4. **生成卡牌分布**：根据地形类型确定卡牌类型权重
5. **生成补给点**：根据距离和难度确定补给点位置

**地形生成规则**：

```
关卡地形生成算法：

1. 计算目标累积爬升：
   - 新手关：200-400m
   - 标准关：400-600m
   - 挑战关：600-800m
   - 精英关：800-1000m
   - BOSS关：1000-1200m

2. 生成地形序列：
   - 每层2公里
   - 确保上坡和下坡的合理交替
   - 避免连续3层都是陡坡
```

#### 4.2.2 天气系统

**天气类型**：（保持原有的天气系统设计）

**天气动态变化**：
- 某些关卡可能在战斗中途天气突变，增加挑战性
- 关卡进行到50%时触发天气变化

### 4.3 休息机制

#### 4.3.1 休息次数限制

| 游戏阶段 | 初始休息次数 | 每次休息消耗 | 最大休息次数 |
|---------|-----------|------------|------------|
| **新手期（1-3关）** | 3次 | 1次 | 3次 |
| **标准期（4-6关）** | 2次 | 1次 | 2次 |
| **挑战期（7-11关）** | 1次 | 1次 | 1次 |
| **突破限制** | 0次 | - | 通过装备/照片卡实现 |

#### 4.3.2 休息效果

| 休息类型 | 恢复效果 | 消耗 | 备注 |
|---------|---------|------|------|
| **快速休息** | 疲劳-5 | 30秒 | 最小恢复 |
| **标准休息** | 疲劳-10，体能+20 | 60秒 | 标准恢复 |
| **深度休息** | 疲劳-15，体能+30，饥饿+20，口渴+20 | 90秒 | 最大恢复 |

### 4.4 补给点设计

#### 4.4.1 补给点生成规则

| 关卡类型 | 补给点间隔 | 补给点数量 | 补给点位置 |
|---------|-----------|-----------|-----------|
| **新手关** | 每2层 | 2个 | 第2层、第4层 |
| **标准关** | 每2-3层 | 2-3个 | 第2层、第4层、第6层 |
| **挑战关** | 每3层 | 3个 | 第3层、第6层、第8层 |
| **精英关** | 每3层 | 3个 | 第3层、第6层、第9层 |
| **BOSS关** | 每3层 | 4个 | 第3层、第6层、第9层、第11层 |

#### 4.4.2 补给点内容

| 补给点类型 | 包含内容 | 价格（环保值） |
|-----------|---------|--------------|
| **小型补给点** | 1瓶矿泉水 + 1根能量棒 | 125环保值 |
| **中型补给点** | 1瓶运动饮料 + 1次巧克力补给 | 125环保值 |
| **大型补给点** | 1次运动补给包 + 1瓶矿泉水 | 175环保值 |
| **超级补给点** | 2次运动补给包 + 照片卡包（基础） | 300环保值 |

### 4.5 游戏流程设计

#### 4.5.1 完整流程

```
开始游戏 → 角色选择/装备 → (升级菜单) → 选择模式（普通/无尽）→ 进入关卡循环 → 通关/失败结算
```

#### 4.5.2 单局流程

```
选择路径&掷天气骰 → 进入战斗场景 → 消除卡牌、收集资源、应对地形与环境 → 通关 → 路线旅程场景（选择下一关路径）→ ... → 击败最终BOSS → 局外结算成长
```

#### 4.5.3 关卡开始流程

1. 显示路线选择界面（2-3个选项）
2. 玩家选择路径后，掷骰子动画
3. 骰子停止，显示本关天气
4. 点击"开始关卡"按钮 → 进入战斗场景

#### 4.5.4 进入战斗场景

**动画序列**：
1. 屏幕渐入（从黑色渐变到场景）
2. 天气仪表盘指针转动到当前值
3. 中央卡牌区生成初始卡牌（逐层生成）
4. 底部资源栏数字从0计数到当前值（数字滚动动画）
5. 左侧五维属性条从0平滑填充到当前值

#### 4.5.5 战斗主流程

```
查看当前层 → 规划消除顺序 → 点击卡牌穿越 → 当前层清空 →
触发向上攀登 → 画面平移 → 下一层成为操作层 → 重复 → 抵达山顶 → 关卡胜利
```

#### 4.5.6 关卡胜利流程

1. 屏幕中央出现"关卡完成"字样（金色大字，伴随烟花特效）
2. 资源飞入动画（徒步数、环保值、照片卡）
3. 属性恢复动画（体能、饥饿、口渴恢复部分值，疲劳值重置为0）
4. 等待玩家点击（点击任意位置进入结算界面）

#### 4.5.7 关卡失败流程

1. 屏幕中央出现"体力耗尽"字样（红色大字，伴随屏幕红色闪烁）
2. 属性栏动画（体能条清零，其他属性条停止更新）
3. 显示本次累计（徒步数、累积爬升，永久保留）
4. 等待玩家点击（点击任意位置进入结算界面）

### 4.6 疲劳突破机制

#### 4.6.1 装备突破

| 装备 | 突破效果 | 说明 |
|------|---------|------|
| **登山靴** | 疲劳积累速度-20% | 减慢疲劳积累 |
| **专业背包** | 疲劳积累速度-30% | 大幅减慢疲劳积累 |
| **登山杖** | 每次休息恢复+20% | 提高休息效率 |

#### 4.6.2 照片卡突破

| 照片卡 | 突破效果 | 说明 |
|--------|---------|------|
| **登山达人** | 疲劳积累速度-25% | 累计使用50次后解锁 |
| **徒步专家** | 疲劳积累速度-50% | 累计使用100次后解锁 |
| **铁人三项** | 疲劳不积累，体能消耗+10% | 终极照片卡 |

#### 4.6.3 游戏后期突破

```
从第7关开始，玩家可以通过以下方式突破疲劳限制：

1. 升级角色属性（消耗徒步数）
2. 收集突破型照片卡
3. 使用高级装备

突破效果：
- 疲劳积累速度大幅降低（最高-100%）
- 可以连续徒步10公里而无需休息
- 但体能消耗会增加（作为平衡）
```

---

**整合说明**：
- 本章将《数值体系与关卡调整方案》的核心内容正式纳入游戏设计文档
- 保持了原有的文档结构和风格
- 所有数值调整都已基于真实徒步标准和路线
- 新增了累积爬升概念、上坡下坡机制、补给系统、疲劳系统等核心机制
